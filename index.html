<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- UPDATE THIS TITLE -->
    <title>SEDKI Iheb // Interactive Embedded Core v1.4.1</title> <!-- Updated Title -->
    <style>
        /* --- CSS Styles (Unchanged) --- */
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        :root { /* ... CSS Variables ... */ --primary-color: #00FFFF; --background-color: #1a1a1a; --text-color: #E0E0E0; --highlight-color: #FFFFFF; --error-color: #FF6347; --warning-color: #FFD700; --success-color: #7FFF00; --prompt-color: var(--primary-color); --scanline-opacity: 0.07; --glow-intensity: 0px 0px 6px; --primary-color-rgb: 0, 255, 255; --fallback-bg: rgba(10, 10, 10, 0.85); --fallback-text: #a0a0a0; --fallback-link: var(--primary-color); --vignette-intensity: 100%; --matrix-color: #33ff33; --matrix-bg: #050a05; }
        body.theme-cyan { /* ... Theme Cyan ... */ --primary-color: #00FFFF; --primary-color-rgb: 0, 255, 255; --prompt-color: var(--primary-color); --highlight-color: #FFFFFF; --fallback-link: var(--primary-color); }
        body.theme-amber { /* ... Theme Amber ... */ --primary-color: #FFBF00; --primary-color-rgb: 255, 191, 0; --prompt-color: var(--primary-color); --highlight-color: #FFFACD; --error-color: #FF4444; --warning-color: #FFCC00; --success-color: #90EE90; --fallback-link: var(--primary-color); }
        body.theme-green { /* ... Theme Green ... */ --primary-color: #00ff00; --primary-color-rgb: 0, 255, 0; --prompt-color: var(--primary-color); --highlight-color: #F0FFF0; --error-color: #ff4444; --warning-color: #ffff00; --success-color: #33ff33; --fallback-link: var(--primary-color); }
        body.theme-ice { /* ... Theme Ice ... */ --primary-color: #87CEFA; --primary-color-rgb: 135, 206, 250; --prompt-color: var(--primary-color); --highlight-color: #F0FFFF; --error-color: #FF6347; --warning-color: #FFD700; --success-color: #98FB98; --fallback-link: var(--primary-color); }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body { /* ... Body Styles ... */ height: 100%; background-color: var(--background-color); color: var(--text-color); font-family: 'VT323', monospace; font-size: 18px; overflow: hidden; cursor: none; -webkit-overflow-scrolling: touch; touch-action: manipulation; }
        body::before { /* Scanlines */ content: " "; display: block; position: absolute; inset: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03)); z-index: 2; background-size: 100% 3px, 5px 100%; pointer-events: none; opacity: var(--scanline-opacity); animation: scanlineWaver 12s linear infinite; }
        body::after { /* Vignette */ content: ""; position: absolute; inset: 0; background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, var(--background-color) var(--vignette-intensity)); z-index: 1; pointer-events: none; animation: vignettePulse 8s ease-in-out infinite alternate; }
        #terminal { /* ... Terminal Styles ... */ position: relative; z-index: 3; padding: 20px; height: 100%; overflow-y: auto; text-shadow: var(--glow-intensity) var(--primary-color); scrollbar-color: var(--primary-color) var(--background-color); scrollbar-width: thin; padding-bottom: 50px; transition: background-color 0.5s ease; }
        #terminal::-webkit-scrollbar { width: 8px; } #terminal::-webkit-scrollbar-track { background: var(--background-color); } #terminal::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: 4px; border: 1px solid var(--background-color); }
        .line { /* ... Line Styles ... */ white-space: pre-wrap; word-break: break-all; margin-bottom: 4px; line-height: 1.3; min-height: 1.3em; }
        .output-line { animation: fadeIn 0.05s forwards; opacity: 0; } .output-line.typing { opacity: 1; animation: none; } .output-line.transient-message { opacity: 1; animation: none; } .output-line.ascii-art-output { opacity: 1; animation: none; }
        .ascii-art-output { /* ... ASCII Art Styles ... */ font-size: 12px; line-height: 1.0; color: var(--primary-color); white-space: pre; overflow-x: auto; scrollbar-color: rgba(var(--primary-color-rgb), 0.5) var(--background-color); scrollbar-width: thin; }
        .ascii-art-output::-webkit-scrollbar { height: 6px; background: var(--background-color);} .ascii-art-output::-webkit-scrollbar-thumb { background-color: rgba(var(--primary-color-rgb), 0.5); border-radius: 3px; }
        #input-line { display: flex; align-items: flex-start; transition: filter 0.1s ease-out, opacity 0.3s ease; }
        .prompt { color: var(--prompt-color); font-weight: bold; margin-right: 8px; flex-shrink: 0; padding-top: 1px; }
        #input-area { flex-grow: 1; outline: none; color: var(--highlight-color); min-height: 1.2em; white-space: pre-wrap; word-break: break-all; }
        .cursor { /* ... Cursor Styles ... */ background-color: var(--primary-color); color: var(--background-color); animation: blink 1.1s step-end infinite; margin-left: 1px; display: inline-block; width: 0.5em; height: 1.2em; vertical-align: bottom; opacity: 1; flex-shrink: 0; }
        .cursor.idle { animation: blink-idle 1.1s step-end infinite; }
        #hidden-input { /* ... Hidden Input Styles ... */ position: absolute; top: -9999px; left: -9999px; opacity: 0; width: 1px; height: 1px; border: none; background: transparent; color: transparent; caret-color: transparent; z-index: -1; pointer-events: none; }
        a { /* ... Link Styles ... */ color: var(--primary-color); text-decoration: underline; cursor: none; text-shadow: var(--glow-intensity) var(--primary-color); transition: background-color 0.1s, color 0.1s; }
        a:hover { background-color: var(--primary-color); color: var(--background-color); text-shadow: none; }
        .highlight { color: var(--highlight-color); font-weight: bold; animation: pulseGlow 3s infinite ease-in-out; }
        .success { color: var(--success-color); } .warning { color: var(--warning-color); } .error { color: var(--error-color); } .dim { color: #888; } .addr { color: #aaa; font-size: 0.9em; }
        #custom-cursor { /* ... Custom Cursor Styles ... */ position: fixed; top: 0; left: 0; width: 8px; height: 16px; background-color: var(--primary-color); pointer-events: none; z-index: 9999; mix-blend-mode: difference; transition: transform 0.1s ease-out, background-color 0.1s ease; opacity: 0.8; display: none; }
        #custom-cursor.hover { transform: scale(1.8); opacity: 1; }
        #fallback-info { /* ... Fallback Info Styles ... */ position: fixed; bottom: 0; left: 0; width: 100%; padding: 5px 15px; background-color: var(--fallback-bg); backdrop-filter: blur(2px); -webkit-backdrop-filter: blur(2px); color: var(--fallback-text); font-family: 'VT323', monospace; font-size: 14px; text-align: center; z-index: 1000; opacity: 0; transition: opacity 0.5s 0.2s ease-in-out; pointer-events: none; display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 10px; border-top: 1px solid rgba(var(--primary-color-rgb), 0.2); }
        #fallback-info.active { opacity: 1; pointer-events: auto; }
        #fallback-info span { margin-right: 10px; } #fallback-info a { color: var(--fallback-link); text-decoration: underline; cursor: pointer; text-shadow: none; margin: 0 5px; white-space: nowrap; } #fallback-info a:hover { background-color: var(--fallback-link); color: var(--background-color); }
        @keyframes commandPulse { 0% { filter: brightness(1.2) saturate(1.1); } 100% { filter: brightness(1) saturate(1); } }
        #input-line.command-executing { animation: commandPulse 0.25s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } } @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } } @keyframes blink-idle { 0%, 100% { opacity: 0.5; } 50% { opacity: 0; } }
        @keyframes pulseGlow { 0%, 100% { text-shadow: var(--glow-intensity) var(--primary-color); opacity: 1; } 50% { text-shadow: 0px 0px 8px var(--primary-color); opacity: 0.9; } }
        @keyframes scanlineWaver { 0%, 100% { opacity: calc(var(--scanline-opacity) * 0.9); background-position: 0 0; } 25% { opacity: calc(var(--scanline-opacity) * 1.1); background-position: 0 1px; } 50% { opacity: calc(var(--scanline-opacity) * 0.85); background-position: 1px 1px; } 75% { opacity: calc(var(--scanline-opacity) * 1.05); background-position: 1px 0; } }
        @keyframes vignettePulse { from { --vignette-intensity: 95%; } to { --vignette-intensity: 100%; } }
        #terminal.matrix-mode { background-color: var(--matrix-bg); scrollbar-color: var(--matrix-color) var(--matrix-bg); }
        #terminal.matrix-mode::-webkit-scrollbar-thumb { background-color: var(--matrix-color); } #terminal.matrix-mode::-webkit-scrollbar-track { background: var(--matrix-bg); }
        .matrix-char { color: var(--matrix-color); text-shadow: 0 0 5px var(--matrix-color); font-family: monospace; display: inline-block; animation: matrixFade 1.5s ease-out forwards; opacity: 1; }
        .matrix-line { white-space: pre; overflow: hidden; opacity: 1; animation: none; line-height: 1.1; margin-bottom: 0; }
        @keyframes matrixFade { from { opacity: 1; } to { opacity: 0; } }
        /* --- Responsive Adjustments (Unchanged) --- */
        @media (max-width: 768px) { body { font-size: 16px; } #terminal { padding: 15px; padding-bottom: 60px; } .ascii-art-output { font-size: 11px; } #fallback-info { font-size: 13px; padding: 8px 10px; gap: 8px;} }
        @media (max-width: 480px) { body { font-size: 15px; cursor: auto; } html, body { touch-action: auto; } #terminal { padding: 10px; padding-bottom: 70px; } .line { line-height: 1.35; min-height: 1.35em; } .addr { display: none; } .ascii-art-output { font-size: 9px; } #custom-cursor { display: none !important; } a { cursor: pointer; } .prompt { padding-top: 0px; } #fallback-info { font-size: 12px; padding: 10px 5px; justify-content: center; gap: 5px 10px; } #fallback-info span { margin-right: 5px;} #fallback-info a { margin: 0 3px; } }
        @media (max-width: 360px) { body { font-size: 14px; } #terminal { padding: 8px; padding-bottom: 75px; } .ascii-art-output { font-size: 8px; } #fallback-info { font-size: 11px; } }
    </style>
</head>
<body class="theme-cyan">

<!-- HTML Structure Remains Unchanged -->
<div id="terminal" onclick="focusInput()"> <div id="output" role="log" aria-live="polite"></div> <div id="input-line" style="display: none;"> <span class="prompt">embedded:/#</span> <span id="input-area"></span> <span class="cursor"></span> </div> </div>
<input id="hidden-input" type="text" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off" aria-label="Command Input">
<div id="custom-cursor"></div>
<div id="fallback-info"> <span id="fallback-name-title"></span> | <a id="fallback-email" href="#">Email</a> | <a id="fallback-linkedin" href="#" target="_blank" rel="noopener noreferrer">LinkedIn</a> | <a id="fallback-cv" href="#" target="_blank" rel="noopener noreferrer" download>Download CV</a> </div>

<script>
    // --- Global Variable Declarations (Unchanged) ---
    let terminal, outputContainer, inputLine, inputArea, hiddenInput, customCursor, cursorElement, fallbackInfo;
    let bootLineDelay = 60; let typeCharDelay = 25; let asciiDrawDelay = 65; let commandIndex = 0; let commandHistory = []; let historyIndex = -1; let isProcessing = false; let processingDelay = 400; let matrixIntervalId = null;

    // =============================================
    // --- YOUR CV DATA --- UPDATED! ---
    // =============================================
    const yourName = "SEDKI Iheb"; // <-- UPDATED
    const yourTitle = "Embedded Software Engineer"; // <-- UPDATED
    // IMPORTANT: Still need the actual link to your CV file!
    const cvLink = "[LINK TO YOUR ACTUAL CV PDF/DOC]"; // <-- Needs update
    const contactEmail = "sdk.iheb@gmail.com"; // <-- UPDATED
    const linkedInLink = "https://www.linkedin.com/in/iheb-sedki/"; // <-- UPDATED
    const githubLink = ""; // <-- Set to empty as not provided
    const portfolioLink = ""; // <-- Set to empty as not provided

    // --- SKILLS - Updated based on your CV ---
    const skills = [
        "C Programming (Expert)",
        "Python (Proficient)",
        "Assembly Language (Proficient)",
        "RTOS: FreeRTOS (Configuration, Application Dev, Porting, Shared Lib Impl.)",
        "Microcontrollers: ARM Cortex-M (M0/M3/M4)",
        "Communication Protocols: BLE, CAN, MQTT, USB, Ethernet, LoRa, Sub-GHz RF",
        "Connectivity: Socket Programming, Cellular Module Integration (U-blox)",
        "Embedded Dev: Firmware Design, Driver Development, HW/SW Integration, Board Bring-up",
        "Debugging: JTAG/SWD, GDB, Oscilloscope, Logic Analyzer, Protocol Analyzers",
        "Specialized: Field-Oriented Control (FOC), FOTA Implementation",
        "Tools: GCC, Keil/IAR (Mention if used), Git, Makefiles/CMake",
        "Test & Measurement: Spectrum Analyzer, VNA, RF Test Equipment",
        "Platforms: Linux (Development Env), RTOS",
        "GUI Dev: Qt Framework (Basic Exposure)", // Optional inclusion
    ];

    // --- PROJECTS - Updated based on your CV ---
    const projects = [
        {
            name: "E-bike Controller Enhancement",
            description: "Architected & developed key C firmware: BLE stack, component management, optimized FOC algorithms. Collaborated with HW team for integration & testing, enhancing stability.",
            url: "#" // Replace with actual link if available
        },
        {
            name: "Cellular IoT Module & FOTA",
            description: "Designed & implemented U-blox cellular driver (C), MQTT middleware, and robust cellular FOTA functionality. Developed Python GUI for FOTA validation.",
            url: "#" // Replace with actual link if available
        },
        {
            name: "Raspberry Pi Automated Test System",
            description: "Engineered RPi-based system for USB-to-dual-CAN bridge validation. Implemented concurrent CAN testing (C), Python socket server, and intuitive GUI.",
            url: "#" // Replace with actual link if available
        },
        {
            name: "FreeRTOS Modularization",
            description: "Architected & demonstrated FreeRTOS as a shared library, enabling multiple applications to link against core RTOS services efficiently.",
            url: "#" // Replace with actual link if available
        }
        // Added 4 key projects, can add more if desired, e.g., RF Validation or Legacy System
    ];
    // =============================================
    // --- END OF CV DATA SECTION ---
    // =============================================

    // --- Boot Sequence Definition (Unchanged) ---
    const bootSequence = [ /* ... unchanged boot sequence ... */ { text: "System Power On.", delay: 100 }, { text: "CPU Core init [ARM Cortex-M4 @ 168MHz]... <span class='success'>OK</span>", delay: 80 }, { text: "Memory Test: ", delay: 30 }, { text: "  SRAM @ <span class='addr'>0x20000000</span> (192KB)... <span class='success'>OK</span>", delay: 60 }, { text: "  FLASH @ <span class='addr'>0x08000000</span> (1MB)... <span class='success'>OK</span>", delay: 60 }, { text: "Clock System init (PLL, HSE)... <span class='success'>OK</span>", delay: 70 }, { text: "Initializing Peripherals:", delay: 50 }, { text: "  GPIO Port A/B/C... <span class='success'>OK</span>", delay: 40 }, { text: "  UART1 @ 115200bps... <span class='success'>OK</span>", delay: 40 }, { text: "  I2C1 Master @ 400kHz... <span class='success'>OK</span>", delay: 40 }, { text: "  SPI2 Slave... <span class='success'>OK</span>", delay: 40 }, { text: "  WDT (Watchdog Timer)... <span class='warning'>Armed (500ms)</span>", delay: 60 }, { text: "Loading Firmware... FW_ID: <span class='dim'>0x${generateFakeHexId(8)}</span>", delay: 100 }, { text: "[ 10% ] Bootloader checksum verification...", delay: 80 }, { text: "[ 50% ] Kernel image decompression...", delay: 150 }, { text: "[ 90% ] Initializing task scheduler (RTOS)...", delay: 100 }, { text: "[ 100% ] Firmware Loaded Successfully.", delay: 50, class: 'success' }, { text: " ", delay: 30 }, { isAscii: true, art: `\n ██████╗ ███╗   ███╗ ███████╗ ███████╗ ██████╗ ███████╗\n ██╔════╝ ████╗ ████║ ██╔════╝ ██╔════╝ ██╔════╝ ██╔════╝\n ██║      ██╔████╔██║ ███████╗ ███████╗ ██║  ███╗ ███████╗\n ██║      ██║╚██╔╝██║ ╚════██║ ╚════██║ ██║   ██║ ╚════██║\n ╚██████╗ ██║ ╚═╝ ██║ ███████║ ███████║ ╚██████╔╝ ███████║\n  ╚═════╝ ╚═╝     ╚═╝ ╚══════╝ ╚══════╝  ╚═════╝  ╚══════╝\n [ CORE INTERFACE v1.4.1 - INTERACTIVE ]`, delay: 150 }, { text: `// Profile Loaded: <span class='highlight'>${yourName}</span> - ${yourTitle}`, delay: 100, type: true }, { text: "// System Initialized. Ready for commands.", delay: 100, class: 'highlight', type: true }, { text: "// Type '<span class='highlight'>help</span>' for commands, or jump straight to:", delay: 80, type: true }, { text: "//   '<span class='highlight'>cv</span>'       - Download Full CV", delay: 80, type: true }, { text: "//   '<span class='highlight'>contact</span>'  - Contact Details & Links", delay: 80, type: true }, { text: "//   '<span class='highlight'>skills</span>'   - View Core Skills", delay: 80, type: true }, { text: " ", delay: 50 }, ];

    // --- Utility Functions (Unchanged) ---
    const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));
    function generateFakeHexId(length) { let result = ''; const characters = 'ABCDEF0123456789'; for (let i = 0; i < length; i++) result += characters.charAt(Math.floor(Math.random() * characters.length)); return result; }
    function scrollToBottom() { setTimeout(() => { if(terminal) terminal.scrollTop = terminal.scrollHeight; }, 0); }

    // --- Core Terminal Functions (Unchanged) ---
    async function typeLine(fullText, targetElement, charDelay) { if (!targetElement) return; targetElement.innerHTML = ''; let currentText = ''; let i = 0; while (i < fullText.length) { scrollToBottom(); if (fullText[i] === '<') { const tagEndIndex = fullText.indexOf('>', i); if (tagEndIndex !== -1) { const tag = fullText.substring(i, tagEndIndex + 1); currentText += tag; targetElement.innerHTML = currentText; i = tagEndIndex + 1; await sleep(charDelay / 2); } else { currentText += fullText[i]; targetElement.innerHTML = currentText; i++; await sleep(charDelay); } } else { currentText += fullText[i]; targetElement.innerHTML = currentText; i++; await sleep(charDelay); } } scrollToBottom(); }
    async function addOutputLine(text, className = '', options = {}) { const type = options.type || false; const delay = options.typeDelay || typeCharDelay; const line = document.createElement('div'); line.className = `line output-line ${className}`; const transientId = `transient-${Date.now()}-${Math.random().toString(36).substring(2, 7)}`; line.dataset.transientId = transientId; if (type) { line.classList.add('typing'); outputContainer.appendChild(line); enableInteractionHints(); await typeLine(text, line, delay); } else { line.innerHTML = text; outputContainer.appendChild(line); enableInteractionHints(); } scrollToBottom(); return transientId; }
    async function addAsciiArt(art, className = '', drawDelay = asciiDrawDelay) { const pre = document.createElement('pre'); pre.className = `line output-line ascii-art-output ${className}`; outputContainer.appendChild(pre); scrollToBottom(); const lines = art.trim().split('\n'); for (const line of lines) { pre.textContent += line + '\n'; scrollToBottom(); await sleep(drawDelay); } pre.textContent = pre.textContent.slice(0, -1); scrollToBottom(); }
    async function runBootSequence() { commandIndex = 0; outputContainer.innerHTML = ''; inputLine.style.display = 'none'; isProcessing = true; fallbackInfo.classList.remove('active'); for (const item of bootSequence) { const delay = item.delay || bootLineDelay; let processedText = item.text; if (typeof processedText === 'string' && processedText.includes('${')) processedText = eval('`' + processedText + '`'); if (item.isAscii) { await addAsciiArt(item.art, item.class || ''); } else if (processedText !== undefined) await addOutputLine(processedText, item.class || '', { type: item.type || false }); await sleep(delay); } finalizeBoot(); }
    function finalizeBoot() { isProcessing = false; showPrompt(); focusInput(); enableInteractionHints(); setTimeout(() => { if(fallbackInfo) fallbackInfo.classList.add('active'); }, 300); }
    function showPrompt() { if(inputLine) inputLine.style.display = 'flex'; scrollToBottom(); }
    function focusInput() { if (hiddenInput && fallbackInfo && cursorElement && document.activeElement !== fallbackInfo && !fallbackInfo.contains(document.activeElement)) hiddenInput.focus(); if(cursorElement) cursorElement.classList.remove('idle'); }

    // ---- Input Event Listeners Setup (Unchanged) ----
    function setupEventListeners() { if (!hiddenInput || !terminal || !customCursor) { console.error("Cannot set up listeners."); return; } hiddenInput.addEventListener('input', () => { if(inputArea) inputArea.textContent = hiddenInput.value; historyIndex = -1; scrollToBottom(); }); hiddenInput.addEventListener('focus', () => { if(cursorElement) cursorElement.classList.remove('idle'); }); hiddenInput.addEventListener('blur', () => { if (!isProcessing && cursorElement) cursorElement.classList.add('idle'); }); hiddenInput.addEventListener('keydown', (e) => { if(cursorElement) cursorElement.classList.remove('idle'); if (e.key === 'Enter') { e.preventDefault(); if (isProcessing) return; const command = hiddenInput.value.trim(); const promptEl = inputLine?.querySelector('.prompt'); const promptText = `<span class="prompt">${promptEl ? promptEl.textContent : ''}</span> ${command.replace(/</g, "&lt;").replace(/>/g, "&gt;")}`; addOutputLine(promptText); handleCommand(command); } else if (e.key === 'ArrowUp') { e.preventDefault(); navigateHistory(1); } else if (e.key === 'ArrowDown') { e.preventDefault(); navigateHistory(-1); } else if (e.key === 'l' && e.ctrlKey) { e.preventDefault(); if (!isProcessing) clearScreenImmediate(); } else if (e.key === 'c' && e.ctrlKey) { e.preventDefault(); if (!isProcessing) { addOutputLine('^C'); hiddenInput.value = ""; if(inputArea) inputArea.textContent = ""; historyIndex = -1; showPrompt(); } } }); terminal.addEventListener('click', (e) => { if (fallbackInfo && e.target.tagName !== 'A' && !fallbackInfo.contains(e.target)) focusInput(); }); document.addEventListener('mousemove', (e) => { if (!customCursor) return; if ('ontouchstart' in window || navigator.maxTouchPoints > 0) { if (customCursor.style.display !== 'none') customCursor.style.display = 'none'; return; } if (customCursor.style.display !== 'block') customCursor.style.display = 'block'; customCursor.style.left = `${e.clientX}px`; customCursor.style.top = `${e.clientY}px`; }); }

    // ---- Command Handling Logic (Includes execution feedback - Unchanged) ---
    async function handleCommand(command) { isProcessing = true; if(cursorElement) cursorElement.classList.add('idle'); if (inputLine) { inputLine.classList.add('command-executing'); setTimeout(() => { inputLine.classList.remove('command-executing'); }, 250); } if (command && (commandHistory.length === 0 || commandHistory[commandHistory.length - 1] !== command)) commandHistory.push(command); historyIndex = -1; if(hiddenInput) hiddenInput.value = ""; if(inputArea) inputArea.textContent = ""; const args = command.split(' ').filter(arg => arg !== ''); const cmd = (args[0] || '').toLowerCase(); await sleep(10); await executeCommand(cmd, args); if (cmd !== 'reboot' && cmd !== 'clear' && cmd !== 'cls' && cmd !== 'matrix') showPrompt(); isProcessing = false; if (cmd !== 'reboot' && cmd !== 'matrix') focusInput(); }
    async function executeCommand(cmd, args) { switch (cmd) { case 'help': showHelp(); break; case 'info': case 'status': await showInfo(); break; case 'skills': await showSkills(); break; case 'projects': await showProjects(); break; case 'contact': await showContact(); break; case 'cv': await showCvLink(); break; case 'clear': case 'cls': clearScreenCommand(); break; case 'reboot': await rebootSystem(); break; case 'theme': await changeTheme(args); break; case 'echo': await addOutputLine(args.slice(1).join(' ').replace(/</g, "&lt;").replace(/>/g, "&gt;")); break; case 'whoami': await addOutputLine(`<span class='highlight'>${yourName}</span> // ${yourTitle}`); break; case 'uname': case 'uname -a': await addOutputLine(`EmbeddedCore OS 1.4.1 ${generateFakeHexId(4)}-generic armv7l GNU/VT323`); break; case 'matrix': await runMatrix(); break; case '': break; default: await addOutputLine(`<span class='error'>Error:</span> Command not found: ${cmd.replace(/</g, "&lt;").replace(/>/g, "&gt;")}`); await addOutputLine(`Type '<span class='highlight'>help</span>' for a list of commands.`); } }
    function navigateHistory(direction) { /* ... unchanged history navigation ... */ if (commandHistory.length === 0) return; const currentHistoryIndex = historyIndex; if (historyIndex === -1) { if (direction === 1) historyIndex = commandHistory.length - 1; } else { if (direction === 1) historyIndex = Math.max(0, historyIndex - 1); else { historyIndex++; if (historyIndex >= commandHistory.length) historyIndex = -1; } } if (historyIndex !== currentHistoryIndex) { const historyCommand = (historyIndex === -1) ? "" : commandHistory[historyIndex]; if(hiddenInput) hiddenInput.value = historyCommand; if(inputArea) inputArea.textContent = historyCommand; setTimeout(() => { if(!hiddenInput) return; const len = hiddenInput.value.length; hiddenInput.setSelectionRange(len, len); hiddenInput.scrollLeft = hiddenInput.scrollWidth; scrollToBottom(); }, 0); } }

    // --- Command Functions ---
    function showHelp() { /* ... unchanged sync help, includes matrix hint ... */ addOutputLine("Available Commands:"); addOutputLine("  <span class='highlight'>help</span>         Displays this help message"); addOutputLine("  <span class='highlight'>info/status</span>  Shows system/profile information"); addOutputLine("  <span class='highlight'>skills</span>       Lists core technical skills"); addOutputLine("  <span class='highlight'>projects</span>     Displays noteworthy projects"); addOutputLine("  <span class='highlight'>contact</span>      Shows contact information and links"); addOutputLine("  <span class='highlight'>cv</span>           Provides link to download the full CV"); addOutputLine("  <span class='highlight'>theme [name]</span> Change color theme (cyan, amber, green, ice)"); addOutputLine("  <span class='highlight'>echo [text]</span>  Prints text back to the terminal"); addOutputLine("  <span class='highlight'>clear/cls</span>    Clears the terminal screen"); addOutputLine("  <span class='highlight'>reboot</span>       Re-initializes the system interface"); addOutputLine("  <span class='dim'>---</span>"); addOutputLine("  <span class='highlight'>whoami</span>       Displays current user profile"); addOutputLine("  <span class='highlight'>uname -a</span>     Shows system information"); addOutputLine("  <span class='highlight'>matrix</span>       ???"); addOutputLine("Shortcuts:"); addOutputLine("  <span class='dim'>Ctrl+L</span>       Clear screen"); addOutputLine("  <span class='dim'>Ctrl+C</span>       Cancel current input line"); addOutputLine("  <span class='dim'>Up/Down Arrow</span>Navigate command history"); }
    async function showInfo() { /* ... unchanged info with transient message ... */ const transientId = await addOutputLine("<span class='dim'>Fetching system status...</span>", 'transient-message'); await sleep(processingDelay / 2); outputContainer?.querySelector(`[data-transient-id="${transientId}"]`)?.remove(); await addOutputLine(`Profile: <span class='highlight'>${yourName}</span>`); await addOutputLine(`Title:   <span class='highlight'>${yourTitle}</span>`); await addOutputLine(`System:  CORE INTERFACE v1.4.1`); await addOutputLine(`Status:  <span class='success'>Online</span> | <span class='dim'>${new Date().toLocaleString()}</span>`); await addOutputLine(`Core:    <span class='dim'>armv7l</span> | Frequency: <span class='dim'>168MHz</span>`); }
    async function showSkills() { /* ... unchanged skills with transient message ... */ const transientId = await addOutputLine("<span class='dim'>Accessing skill database...</span>", 'transient-message'); await sleep(processingDelay); outputContainer?.querySelector(`[data-transient-id="${transientId}"]`)?.remove(); await addOutputLine("<span class='highlight'>Core Competencies:</span>"); for (const skill of skills) { await addOutputLine(`  <span class='success'>*</span> ${skill}`); } }
    async function showProjects() { /* ... unchanged projects with transient message ... */ const transientId = await addOutputLine("<span class='dim'>Loading project portfolio...</span>", 'transient-message'); await sleep(processingDelay); outputContainer?.querySelector(`[data-transient-id="${transientId}"]`)?.remove(); await addOutputLine("<span class='highlight'>Noteworthy Firmware/Systems:</span>"); if (projects.length === 0) { await addOutputLine("  <span class='dim'>No projects listed.</span>"); return; } for (const proj of projects) { let projText = `  <span class='success'>#</span> <span class='highlight'>${proj.name}:</span> ${proj.description}`; if (proj.url && proj.url !== '#') { projText += ` [<a href='${proj.url}' target='_blank' rel='noopener noreferrer' onclick='focusInputAfterClick(event)' style='text-decoration: underline dotted;'>details</a>]`; } await addOutputLine(projText); } }
    async function showContact() { /* ... unchanged instant contact (still async) ... */ await addOutputLine("<span class='highlight'>Comms & Resources:</span>"); await addOutputLine(`  <span class='success'>></span> Email: <a href='mailto:${contactEmail}' onclick='focusInputAfterClick(event)'>${contactEmail}</a>`); const dL = linkedInLink.startsWith('http')?linkedInLink.split('/').filter(Boolean).slice(-2).join('/'):linkedInLink; await addOutputLine(`  <span class='success'>></span> LinkedIn: <a href='${linkedInLink}' target='_blank' rel='noopener noreferrer' onclick='focusInputAfterClick(event)'>${dL||'Link'}</a>`); if(githubLink){const dG=githubLink.startsWith('http')?githubLink.split('/').filter(Boolean).pop():githubLink; await addOutputLine(`  <span class='success'>></span> GitHub: <a href='${githubLink}' target='_blank' rel='noopener noreferrer' onclick='focusInputAfterClick(event)'>${dG||'Link'}</a>`);} if(portfolioLink){const dP=portfolioLink.startsWith('http')?portfolioLink.replace(/^https?:\/\//,''):portfolioLink; await addOutputLine(`  <span class='success'>></span> Portfolio: <a href='${portfolioLink}' target='_blank' rel='noopener noreferrer' onclick='focusInputAfterClick(event)'>${dP||'Visit Site'}</a>`);} }
    async function showCvLink() { /* ... unchanged instant cv link (still async) ... */ await addOutputLine("<span class='highlight'>Full Curriculum Vitae:</span>"); await addOutputLine(`  Download the complete document:`); const filename = yourName.replace(/[^a-z0-9]/gi, '_').replace(/_+/g, '_') + '_CV.pdf'; await addOutputLine(`  <span class='success'>></span> <a href='${cvLink}' target='_blank' rel='noopener noreferrer' download='${filename}' onclick='focusInputAfterClick(event)'>${filename}</a>`); }
    function focusInputAfterClick(event) { /* ... unchanged focus helper ... */ if (event.currentTarget.getAttribute('href') === '#') event.preventDefault(); setTimeout(focusInput, 100); }
    function clearScreenCommand() { if(outputContainer) outputContainer.innerHTML = ''; }
    function clearScreenImmediate() { /* ... unchanged immediate clear ... */ if(outputContainer) outputContainer.innerHTML = ''; if(hiddenInput) hiddenInput.value = ""; if(inputArea) inputArea.textContent = ""; historyIndex = -1; showPrompt(); }
    async function rebootSystem() { /* ... unchanged reboot logic ... */ if(inputLine) inputLine.style.display = 'none'; isProcessing = true; if(fallbackInfo) fallbackInfo.classList.remove('active'); await addOutputLine("<span class='warning'>System reboot requested...</span>"); await addOutputLine("<span class='dim'>Re-initializing interface...</span>"); await sleep(1500); await runBootSequence(); }
    async function changeTheme(args) { /* ... updated changeTheme logic with 'ice' ... */ const themeName = (args[1] || '').toLowerCase(); const availableThemes = ['cyan', 'amber', 'green', 'ice']; if (themeName && availableThemes.includes(themeName)) { setTheme(themeName); await addOutputLine(`Color theme changed to <span class='highlight'>${themeName}</span>.`); } else if (themeName) { await addOutputLine(`<span class='error'>Error:</span> Invalid theme: ${themeName}. Use: ${availableThemes.join('|')}`); } else { await addOutputLine(`Usage: theme [${availableThemes.join('|')}]`); } }
    async function runMatrix() { /* ... unchanged matrix function ... */ if (!terminal || !outputContainer || !inputLine || !fallbackInfo) return; isProcessing = true; const originalContent = outputContainer.innerHTML; const matrixDuration = 8000; const matrixInterval = 75; const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ﾊﾐﾋｰｳｼﾅﾓﾆｻﾜﾂｵﾘｱﾎﾃﾏｹﾒｴｶｷﾑﾕﾗｾﾈｽﾀﾇﾍｦｲｸｺｿﾁﾄﾉﾌﾔﾖﾙﾚﾛﾝ"; let cols = Math.floor(terminal.clientWidth / 10); inputLine.style.opacity = '0'; inputLine.style.pointerEvents = 'none'; fallbackInfo.classList.remove('active'); terminal.classList.add('matrix-mode'); await sleep(300); outputContainer.innerHTML = ''; matrixIntervalId = setInterval(() => { if (!outputContainer) { clearInterval(matrixIntervalId); return; } cols = Math.floor(terminal.clientWidth / 10); let lineText = ''; for (let i = 0; i < cols; i++) { lineText += chars.charAt(Math.floor(Math.random() * chars.length)); } const line = document.createElement('div'); line.className = 'line matrix-line'; lineText.split('').forEach(char => { const span = document.createElement('span'); span.className = 'matrix-char'; span.textContent = char; line.appendChild(span); }); outputContainer.appendChild(line); const maxLines = 50; while (outputContainer.children.length > maxLines) { outputContainer.removeChild(outputContainer.firstChild); } scrollToBottom(); }, matrixInterval); setTimeout(async () => { if (matrixIntervalId) clearInterval(matrixIntervalId); matrixIntervalId = null; terminal.classList.remove('matrix-mode'); outputContainer.style.transition = 'opacity 0.5s ease-out'; outputContainer.style.opacity = '0'; await sleep(500); outputContainer.innerHTML = originalContent; outputContainer.style.opacity = '1'; outputContainer.style.transition = ''; enableInteractionHints(); inputLine.style.opacity = '1'; inputLine.style.pointerEvents = 'auto'; if (fallbackInfo) fallbackInfo.classList.add('active'); showPrompt(); isProcessing = false; focusInput(); }, matrixDuration); }

    // --- Custom Cursor & Link Hover Logic (Unchanged) ---
    function enableInteractionHints() { if(!outputContainer || !customCursor) return; outputContainer.removeEventListener('mouseover', handleLinkHover); outputContainer.removeEventListener('mouseout', handleLinkHover); outputContainer.addEventListener('mouseover', handleLinkHover); outputContainer.addEventListener('mouseout', handleLinkHover); const primaryColor = getComputedStyle(document.body).getPropertyValue('--primary-color').trim(); customCursor.style.backgroundColor = primaryColor; }
    function handleLinkHover(e) { if (!customCursor) return; if (customCursor.style.display === 'block' && e.target.tagName === 'A') customCursor.classList.toggle('hover', e.type === 'mouseover'); else customCursor.classList.remove('hover'); }

    // --- Theme Switcher (Unchanged) ---
    function hexToRgb(hex) { const shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i; hex = hex.replace(shorthandRegex, (m, r, g, b) => r + r + g + g + b + b); const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex); return result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16) } : null; }
    function updateThemeRgbVariable() { const primaryColorHex = getComputedStyle(document.body).getPropertyValue('--primary-color').trim(); const rgb = hexToRgb(primaryColorHex); if (rgb) document.documentElement.style.setProperty('--primary-color-rgb', `${rgb.r}, ${rgb.g}, ${rgb.b}`); else { document.documentElement.style.setProperty('--primary-color-rgb', '0, 255, 255'); console.warn("Could not parse primary color HEX to RGB, using fallback."); } }
    function setTheme(themeName) { document.body.className = `theme-${themeName}`; setTimeout(() => { const newPrimaryColor = getComputedStyle(document.body).getPropertyValue('--primary-color').trim(); if(customCursor) customCursor.style.backgroundColor = newPrimaryColor; if(cursorElement) cursorElement.style.backgroundColor = newPrimaryColor; updateThemeRgbVariable(); enableInteractionHints(); console.log(`Theme set to: ${themeName}`); }, 0); }

    // --- Initialisation (Unchanged) ---
    document.addEventListener('DOMContentLoaded', () => {
        terminal = document.getElementById('terminal'); outputContainer = document.getElementById('output'); inputLine = document.getElementById('input-line'); inputArea = document.getElementById('input-area'); hiddenInput = document.getElementById('hidden-input'); customCursor = document.getElementById('custom-cursor'); cursorElement = inputLine ? inputLine.querySelector('.cursor') : null; fallbackInfo = document.getElementById('fallback-info');
        if (!terminal || !outputContainer || !inputLine || !inputArea || !hiddenInput || !cursorElement || !fallbackInfo) { console.error("Initialization failed: One or more essential DOM elements not found."); if(outputContainer) outputContainer.innerHTML = "<div class='line error'>Error: Interface failed to initialize. Please check console.</div>"; return; }
        const fbNameTitle = document.getElementById('fallback-name-title'); const fbEmail = document.getElementById('fallback-email'); const fbLinkedIn = document.getElementById('fallback-linkedin'); const fbCv = document.getElementById('fallback-cv'); if(fbNameTitle) fbNameTitle.textContent = `${yourName} | ${yourTitle}`; if(fbEmail) { fbEmail.href = `mailto:${contactEmail}`; fbEmail.textContent = 'Email'; } if(fbLinkedIn) fbLinkedIn.href = linkedInLink; if(fbCv) { fbCv.href = cvLink; const filename = yourName.replace(/[^a-z0-9]/gi, '_').replace(/_+/g, '_') + '_CV.pdf'; fbCv.download = filename; }
        setupEventListeners(); const initialTheme = document.body.className.split(' ').find(cls => cls.startsWith('theme-')) || 'theme-cyan'; setTheme(initialTheme.replace('theme-', '')); runBootSequence(); });

</script>

</body>
</html>